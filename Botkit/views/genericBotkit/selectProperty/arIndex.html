<!doctype html>
<html lang="en">

<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link rel=icon href=https://kore-wordpress.s3.us-east-2.amazonaws.com/wp-content/uploads/2021/09/18213142/fav-icon.png sizes=32x32>
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.2/css/bootstrap.min.css" integrity="sha384-Smlep5jCw/wG7hdkwQ/Z5nLIefveQRIY9nfy6xoR1uRYBtpZgI6339F5dgvm/e9B" crossorigin="anonymous">
    <link rel="stylesheet" type="text/css" href="css/styles.css">
    <link rel="stylesheet" type="text/css" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
    <title>KORE.AI</title>
</head>

<body class="demoPortalBody">

    <!-- HEADER -->
    <nav class="navbar navbar-expand-md bg-dark navbar-dark navMainDesktop">
        <div class="container">
            <div class="col-3"><a href="https://kore.ai/"><img src="https://resourceportal.kore.ai/wp-content/themes/demoportal/images/logo.png" class="logoImage"></a></div>
            
        </div>
    </nav>
    
    <!-- HEADER -->
    <!-- CONTAINER -->
<div class="container-fluid demoPortalContainer library">
<div class="container">

<!--CHANNELS LIST-->
<div class="row wow fadeIn channelsList" id="holder">

</div>

</div>
</div>


    <!-- CONTAINER -->

    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.0/jquery.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.2/js/bootstrap.min.js" integrity="sha384-o+RDsa0aLu++PJvFqy8fFScvbHFLtbvScb8AjopnFD+iEQ7wo/CG0xlczd+2O/em" crossorigin="anonymous"></script>
   
</body>

</html>
<script>

var url_string = window.location.href;
var url = new URL(decodeURI(url_string));
//alert(url);

var holder = document.getElementById("holder");
var desc = url.searchParams.get("propertyDetails");
var hotelDetails = JSON.parse(desc);

for(let i=0;i<hotelDetails.length;i++)
    {
holder.innerHTML += "<div class='col-md-3 mb-4 channelDetails'><div class='card' style='text-align: center;'><div class='card-body'><img class='channelIcon' style='height: 176px;width: 218px;' id='hotel_image1' src='"+hotelDetails[i].image+"'><br><br><p class='type' id='hotel_name1"+i+"'>"+hotelDetails[i].location+"</p><p class='Description' id=desc1>"+hotelDetails[i].budget+"</p><p class='Description' id=desc1>"+hotelDetails[i].name+"</p><p class='Description' id=desc1><a href='"+hotelDetails[i].maplink+"' target='_blank'>رابط الموقع</a></p></div><div class='detailsButton'><button type='button' class='btn btn-primary details' id='"+hotelDetails[i].name+hotelDetails[i].maplink+"' onclick='getClickID(this.id)'>يختار</button></div></div></div>";
			
}

 function getClickID(clickID) {
            //alert(clickID);
			const before_ = clickID.substring(0, clickID.indexOf('https://'));
			//alert(before_);
			var first_hotel_value = clickID;
			const url_loc = first_hotel_value.split('https://').pop();
			//alert(url_loc);
			
			postClick(before_,url_loc);
        }

</script>

<script>
    function postClick(first_hotel_value,maplink){
	//alert(first_hotel_value);
        let url_string = window.location.href;
        let url = new URL(decodeURI(url_string));
        let requestId = url.searchParams.get("requestId");
        article = $(this).text();

        var data = JSON.stringify({
            "requestId": requestId,
			"name": first_hotel_value,
			"mapLink":encodeURI(maplink)
        });
        console.log(data);
        var xhr = new XMLHttpRequest();
        xhr.withCredentials = true;

        xhr.addEventListener("readystatechange", function () {
            if (this.readyState === 4) {
                console.log(this.responseText);
                var customWindow = window.open('', '_blank', '');
                customWindow.close();
				leave();
            }
        });
        xhr.open("POST", window.location.origin + "/genericBotkit/selectProperty");
        xhr.setRequestHeader("Content-Type", "application/json");

        xhr.send(data);
    } 
	
	function leave() {
  var myWindow = window.open("", "_self");
  myWindow.document.write("");
  setTimeout (function() {myWindow.close();},1000);
}
  
</script>

